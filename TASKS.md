# 午餐點餐平台 - 任務清單

## 專案概述
建立一個公司內部午餐點餐協作平台，支援手機優先的響應式設計，並提供召集人管理店家與品項的功能，最後統整所有點餐資訊與金額。

## 核心功能模組

### 1. 專案架構與環境設定
- [x] 初始化前端專案（Vue + TypeScript）
- [x] 設定響應式設計框架（Tailwind CSS / Vuetify / Element Plus）
- [x] 初始化後端專案（NestJS）
- [x] 設定資料庫（SQLite/PostgreSQL/MySQL）
- [x] 配置開發環境與生產環境變數
- [x] 設定 API 路由結構
- [x] 配置 CORS 與安全性設定
- [x] 設定版本控制（Git）與 .gitignore
- [x] 設定一個指令 同時啟動前後端服務

### 2. 用戶認證與授權系統
- [ ] 設計用戶資料模型（僅召集人需要註冊，匿名用戶無需註冊）
- [ ] 實作召集人註冊功能（使用者名稱、暱稱（可選）、密碼）
- [ ] 實作召集人登入/登出功能
- [ ] 實作角色管理（僅召集人角色）
- [ ] 實作權限控制中間件（保護後台功能）
- [ ] 實作 JWT 認證機制
- [ ] 設計後台首頁（功能列表：店家管理、品項管理、開始點餐、訂單管理、歷史訂單、登出）

### 3. 店家管理功能（召集人專用）
- [ ] 設計店家資料模型（名稱、聯絡方式、備註、圖片 URL、分類標籤、排序順序、啟用狀態）
- [ ] 建立店家列表頁面（召集人介面）
- [ ] 實作新增店家功能（表單驗證，包含所有欄位）****
- [ ] 實作編輯店家功能
- [ ] 實作刪除店家功能（含確認機制，刪除時一併刪除所有品項）
- [ ] 實作店家啟用/停用狀態切換（停用的店家不會在點餐頁面顯示）
- [ ] 設計店家卡片/列表 UI（響應式）

### 4. 品項管理功能（召集人專用）
- [ ] 設計品項資料模型（名稱、價格、描述、圖片 URL、分類、排序順序、是否推薦、啟用狀態、所屬店家）
- [ ] 設計客製化選項資料模型（選項名稱、選項值、預設值、範本）
- [ ] 建立品項管理 Modal（從店家管理頁面進入）
- [ ] 實作新增品項功能（關聯到店家，包含所有欄位）
- [ ] 實作客製化選項設定功能（新增、編輯、刪除客製化選項，支援範本快速套用）
- [ ] 實作編輯品項功能（包含客製化選項）
- [ ] 實作刪除品項功能（含確認機制）
- [ ] 實作品項啟用/停用狀態切換（停用的品項不會在點餐頁面顯示）
- [ ] 實作批量匯入品項功能（CSV 格式，包含範本下載）
- [ ] 設計品項卡片/列表 UI（響應式）

### 5. 點餐功能（匿名用戶）
- [ ] 設計點餐訂單資料模型（訂單名稱、截止時間、指定店家、分享 Token、訂單狀態、建立日期）
- [ ] 設計點餐項目資料模型（參與者姓名、品項、數量、客製化選項、備註、小計）
- [ ] 實作建立點餐訂單功能（召集人：訂單名稱、截止時間、選擇店家）
- [ ] 實作產生分享 Token 功能（唯一識別碼）
- [ ] 實作產生分享連結功能（包含 Token，支援姓名參數 `?name=xxx`）
- [ ] 實作產生 QRCode 功能（SVG 格式，可包含預填姓名）
- [ ] 實作重新產生 Token 功能（舊連結失效）
- [ ] 建立匿名點餐頁面（透過分享連結或 QRCode 進入）
- [ ] 實作姓名輸入功能（首次進入時彈出對話框，支援 URL 參數預填）
- [ ] 實作瀏覽品項功能（僅顯示訂單指定的店家的啟用品項）
- [ ] 實作品項分類導航功能（頂部分類標籤快速跳轉）
- [ ] 實作品項搜尋功能（在店家內搜尋品項名稱）
- [ ] 實作品項篩選功能（按分類、價格範圍篩選）
- [ ] 實作加入購物車功能（無客製化選項直接加入，有客製化選項彈出 Modal）
- [ ] 實作客製化選項選擇功能（顯示所有選項，預設選擇第一個值）
- [ ] 實作購物車管理功能（查看、增加/減少數量、刪除品項）
- [ ] 實作購物車浮動按鈕（顯示總數量和總金額）
- [ ] 實作訂單備註功能（在購物車中填寫）
- [ ] 實作提交點餐功能（確認對話框、成功提示、自動清空購物車）
- [ ] 實作修改訂單功能（截止時間前可修改，顯示「修改訂單」按鈕）
- [ ] 實作取消訂單功能（截止時間前可取消）
- [ ] 實作訂單狀態檢查（截止時間後或關閉後無法點餐）
- [ ] 設計手機優先的點餐介面 UI（響應式設計）

### 6. 訂單管理與統整功能
- [ ] 設計訂單管理資料模型（訂單ID、訂單名稱、訂餐店家、訂單狀態、建立日期、截止時間）
- [ ] 建立訂單管理頁面（召集人介面，使用表格呈現）
- [ ] 實作訂單列表顯示功能（表格欄位：訂單ID、訂單名稱、訂餐店家、訂單狀態、建立日期、截止時間、操作按鈕）
- [ ] 實作訂單詳細資訊功能（Modal 視窗：顯示訂單總金額、誰點了什麼、點了多少錢）
- [ ] 實作結束訂單功能（手動關閉訂單，僅在訂單狀態為開放時顯示按鈕）
- [ ] 實作訂單狀態管理（開放點餐、已截止、已完成）
- [ ] 實作自動截止功能（到達截止時間後自動關閉訂單）
- [ ] 實作訂單統計功能（總訂單數、總金額、按店家分組統計、按品項分組統計、個人分攤金額）
- [ ] 實作匯出訂單功能（CSV 格式、PDF 格式）
- [ ] 設計訂單管理表格 UI（響應式設計）
- [ ] 設計訂單詳細資訊 Modal UI

### 7. 歷史記錄功能
- [ ] 設計歷史訂單資料模型（繼承訂單管理資料模型）
- [ ] 建立歷史訂單列表頁面（召集人介面）
- [ ] 實作查看歷史訂單功能（顯示所有歷史訂單）
- [ ] 實作歷史訂單搜尋功能（日期範圍、店家名稱、訂單名稱）
- [ ] 實作點擊訂單查看詳細資訊功能
- [ ] 設計歷史記錄 UI（響應式設計）

### 8. 通知與提醒功能（可選）
- [ ] 實作訂單截止提醒（Email/Line/推播）
- [ ] 實作訂單統整完成通知
- [ ] 實作點餐開始通知
- [ ] 設定通知偏好設定

### 9. 手機優化與響應式設計
- [ ] 優化手機版導航選單（漢堡選單）
- [ ] 優化觸控操作體驗
- [ ] 實作手機版點餐流程優化
- [ ] 測試各種手機螢幕尺寸適配
- [ ] 優化圖片載入與效能
- [ ] 實作 PWA 功能（可選：離線使用、安裝到桌面）

### 10. API 開發
- [ ] 設計 RESTful API 規格文件
- [ ] 實作用戶認證相關 API（註冊、登入、登出）
- [ ] 實作店家管理相關 API（CRUD、啟用/停用）
- [ ] 實作品項管理相關 API（CRUD、啟用/停用、客製化選項、批量匯入）
- [ ] 實作點餐訂單相關 API（建立訂單、產生 Token、產生 QRCode、重新產生 Token）
- [ ] 實作匿名點餐相關 API（透過 Token 取得訂單資訊、提交點餐、修改訂單、取消訂單）
- [ ] 實作訂單管理相關 API（列表、詳細資訊、結束訂單、統計、匯出）
- [ ] 實作歷史訂單相關 API（列表、搜尋、詳細資訊）
- [ ] 實作 API 錯誤處理
- [ ] 實作 API 請求驗證與資料驗證
- [ ] 設定 API 速率限制

### 11. 資料庫設計
- [ ] 設計用戶資料表（Users：id, username, nickname, password, role）
- [ ] 設計店家資料表（Stores：id, name, contact, notes, image_url, category_tags, sort_order, is_active）
- [ ] 設計品項資料表（Items：id, store_id, name, price, description, image_url, category, sort_order, is_recommended, is_active）
- [ ] 設計客製化選項資料表（CustomizationOptions：id, item_id, option_name, option_values, default_value, template）
- [ ] 設計點餐訂單資料表（Orders：id, name, deadline, store_id, share_token, status, created_at）
- [ ] 設計點餐項目資料表（OrderItems：id, order_id, participant_name, item_id, quantity, customization, notes, subtotal）
- [ ] 設計關聯表與外鍵約束（Items -> Stores, OrderItems -> Orders, OrderItems -> Items, CustomizationOptions -> Items）
- [ ] 設計資料庫索引優化（share_token, order_id, store_id, item_id）
- [ ] 實作資料庫遷移腳本

### 12. 測試
- [ ] 撰寫單元測試（前端組件）
- [ ] 撰寫單元測試（後端 API）
- [ ] 撰寫整合測試
- [ ] 實作 E2E 測試（可選）
- [ ] 進行跨瀏覽器測試
- [ ] 進行手機裝置實機測試

### 13. 部署與維護
- [ ] 選擇部署平台（Vercel/Netlify + Heroku/AWS/VPS）
- [ ] 設定生產環境資料庫
- [ ] 設定 CI/CD 流程
- [ ] 設定域名與 SSL 憑證
- [ ] 設定監控與日誌系統
- [ ] 撰寫部署文件
- [ ] 建立備份機制

### 14. 文件撰寫
- [ ] 撰寫專案 README.md
- [ ] 撰寫 API 文件
- [ ] 撰寫使用者手冊（召集人版）
- [ ] 撰寫使用者手冊（一般用戶版）
- [ ] 撰寫開發者文件
- [ ] 撰寫部署文件

## 技術建議

### 前端技術棧
- **框架**: Vue + TypeScript
- **UI 框架**: Tailwind CSS 或 Vuetify/Element Plus（支援響應式設計）
- **狀態管理**: Pinia
- **路由**: Vue Router
- **HTTP 客戶端**: Axios
- **表單處理**: VeeValidate 

### 後端技術棧
- **框架**: NestJS
- **資料庫**: PostgreSQL 或 MySQL（開發階段可用 SQLite）
- **ORM**: TypeORM（NestJS 官方推薦）或 Prisma
- **認證**: JWT 或 Session

### 認證方式說明
根據使用流程文件：
- **召集人**：使用使用者名稱和密碼註冊與登入
- **匿名用戶**：無需註冊，透過分享連結或 QRCode 進入點餐頁面，僅需輸入姓名

## 開發優先順序建議

### Phase 1: MVP（最小可行產品）
1. 專案架構與環境設定
2. 召集人認證（註冊、登入）
3. 店家管理功能（召集人）
4. 品項管理功能（召集人，包含客製化選項）
5. 建立點餐訂單功能（產生分享連結和 QRCode）
6. 匿名點餐功能（透過分享連結進入、輸入姓名、選擇品項、購物車、提交訂單）
7. 訂單管理功能（查看訂單、詳細資訊、結束訂單）
8. 訂單統計與匯出功能

### Phase 2: 優化與擴充
1. 手機優化與響應式設計
2. 歷史記錄功能
3. 訂單修改與取消功能（截止時間前）
4. 批量匯入品項功能
5. 進階 UI/UX 優化（分類導航、搜尋、篩選）

### Phase 3: 進階功能
1. 通知與提醒功能
2. PWA 功能
3. 統計圖表
4. 客製化選項範本功能
5. QRCode 預填姓名功能

## 注意事項

1. **資料安全**：確保點餐資料僅供內部使用，設定適當的存取權限
2. **效能優化**：手機網路可能較慢，需優化 API 回應時間與前端載入速度
3. **使用者體驗**：點餐流程應簡單直覺，減少操作步驟
4. **錯誤處理**：提供清楚的錯誤訊息與操作指引
5. **資料備份**：定期備份訂單資料，避免資料遺失
